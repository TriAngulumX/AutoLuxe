<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AutoLuxe - Sign Up</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400..900&family=Quicksand:wght@300..700&display=swap"
      rel="stylesheet"
    />

    <!-- Style -->
    <link rel="stylesheet" href="style.css" />
    <style>
      /* Background */
      html {
        height: 100%;
      }
      body {
        margin: 0;
        padding: 0;
        font-family: "Quicksand", sans-serif;
        color: #fff;
        background: url("IMG/dark.jpg") no-repeat center center;
        background-size: cover;
      }

      /* Container */
      .register {
        text-align: center;
        position: absolute;
        top: 50%;
        left: 50%;
        width: 700px;
        transform: translate(-50%, -50%);
        background: rgba(31, 30, 30, 0.566);
        box-shadow: 10px;
        box-sizing: border-box;
        border: 8px;
        padding: 40px;
      }

      /* Header */
      .register h1 {
        font-family: "Orbitron", sans-serif;
        font-size: 36px;
        color: white;
      }

      .register h2 {
        font-size: 20px;
        margin-bottom: 40px;
        color: #ddd;
      }

      /* Form */
      form {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .user input,
      .dropdown-container select {
        width: 100%;
        padding: 10px;
        font-size: 16px;
        border: none;
        background: transparent;
        color: #fff;
        box-sizing: border-box;
        border-bottom: 2px solid white;
      }

      .user input:focus {
        background-color: transparent;
      }
      .dropdown-container select:focus {
        background-color: rgb(19, 18, 18);
        padding: 10px;
      }

      /* Toggle Password */
      .toggle-pass {
        display: block;
        margin-top: 5px;
        font-size: 20px;
        cursor: pointer;
        color: #ffffff;
        text-align: right;
        padding: 2% 3%;
        transition: 0.6s ease;
      }

      .toggle-pass:hover {
        color: #086195;
      }

      /* Error Message */
      .error {
        color: #ff4d4d;
        font-size: 18px;
        text-align: left;
        margin-top: -10px;
      }

      /* Submit Button */
      button {
        padding: 10px;
        font-size: 16px;
        font-weight: bold;
        color: #fff;
        background: #000000;
        border: none;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      button:hover {
        background: #fefefe;
        color: black;
      }

      /* Responsive Design */
      @media (max-width: 480px) {
        .register {
          width: 90%;
        }
      }
      .cta {
        cursor: pointer;
        text-decoration: none;
        color: #009df8;
        transition: 0.5s ease;
      }
      .cta:hover {
        color: white;
      }
    </style>
  </head>
  <body>
    <div class="register">
      <h1>AutoLuxe</h1>
      <h2>Sign Up</h2>
      <form id="registerform">
        <div class="user">
          <input type="text" id="username" placeholder="Username" required />
          <small class="error" id="usernameError"></small>
        </div>
        <div class="user">
          <input type="text" id="email" placeholder="Email" required />
          <small class="error" id="emailError"></small>
        </div>
        <div class="dropdown-container">
          <select id="region" required>
            <option value="">Select Region</option>
            <option value="Sumatera">Sumatera</option>
            <option value="Jawa">Jawa</option>
            <option value="Kalimantan">Kalimantan</option>
            <option value="Sulawesi">Sulawesi</option>
            <option value="Papua">Papua</option>
          </select>
          <small class="error" id="regionError"></small>
          <br />
          <select id="province" disabled required>
            <option value="">Select Province</option>
          </select>
          <small class="error" id="provinceError"></small>
          <br />
          <select id="city" disabled required>
            <option value="">Select City</option>
          </select>
          <small class="error" id="cityError"></small>
        </div>

        <div class="user">
          <input
            type="password"
            id="password"
            placeholder="Password"
            required
          />
          <span class="toggle-pass" onclick="togglePassword()">Show</span>
          <small class="error" id="passwordError"></small>
        </div>

        <button id="submitButton" type="button">Sign Up</button>
        <p>Already have account? <a href="index.html" class="cta">Login </a></p>
      </form>
    </div>

    <script>
      // Data kota berdasarkan wilayah dan provinsi
      const data = {
        Sumatera: {
          Aceh: ["Banda Aceh", "Langsa", "Lhokseumawe", "Meulaboh"],
          "Sumatera Utara": [
            "Medan",
            "Binjai",
            "Pematangsiantar",
            "Tebing Tinggi",
          ],
          Lampung: ["Bandar Lampung", "Metro"],
        },
        Jawa: {
          "Jawa Barat": ["Bandung", "Bekasi", "Depok"],
          "Jawa Tengah": ["Semarang", "Solo", "Magelang"],
          Banten: ["Serang", "Tangerang", "Cilegon"],
        },
        Kalimantan: {
          "Kalimantan Barat": ["Pontianak", "Singkawang", "Ketapang", "Sambas"],
          "Kalimantan Tengah": [
            "Palangka Raya",
            "Sampit",
            "Pangkalan Bun",
            "Kapuas",
          ],
          "Kalimantan Selatan": [
            "Banjarmasin",
            "Banjarbaru",
            "Martapura",
            "Barabai",
          ],
          "Kalimantan Timur": [
            "Samarinda",
            "Balikpapan",
            "Bontang",
            "Tenggarong",
          ],
          "Kalimantan Utara": [
            "Tanjung Selor",
            "Tarakan",
            "Nunukan",
            "Malinau",
          ],
        },
        Sulawesi: {
          "Sulawesi Utara": ["Manado", "Tomohon", "Bitung", "Airmadidi"],
          "Sulawesi Tengah": ["Palu", "Poso", "Tolitoli", "Luwuk"],
          "Sulawesi Selatan": ["Makassar", "Palopo", "Parepare", "Sengkang"],
          "Sulawesi Barat": ["Mamuju", "Polewali Mandar", "Majene"],
          Gorontalo: ["Gorontalo", "Limboto", "Tilamuta"],
          "Sulawesi Tenggara": ["Kendari", "Baubau", "Kolaka", "Wakatobi"],
        },
        Papua: {
          Papua: ["Jayapura", "Timika", "Wamena", "Sentani"],
          "Papua Barat": ["Manokwari", "Sorong", "Raja Ampat", "Fakfak"],
          "Papua Tengah": ["Nabire", "Paniai", "Intan Jaya"],
          "Papua Selatan": ["Merauke", "Asmat", "Boven Digoel"],
          "Papua Pegunungan": ["Wamena", "Yahukimo", "Puncak Jaya"],
        },
      };

      const regionSelect = document.getElementById("region");
      const provinceSelect = document.getElementById("province");
      const citySelect = document.getElementById("city");

      // Event listener untuk perubahan region
      regionSelect.addEventListener("change", () => {
        const selectedRegion = regionSelect.value;
        provinceSelect.innerHTML = '<option value="">Select Province</option>';
        citySelect.innerHTML = '<option value="">Select City</option>';
        citySelect.disabled = true;

        if (selectedRegion && data[selectedRegion]) {
          provinceSelect.disabled = false;
          Object.keys(data[selectedRegion]).forEach((province) => {
            const option = document.createElement("option");
            option.value = province;
            option.textContent = province;
            provinceSelect.appendChild(option);
          });
        } else {
          provinceSelect.disabled = true;
        }
      });

      // Event listener untuk perubahan province
      provinceSelect.addEventListener("change", () => {
        const selectedRegion = regionSelect.value;
        const selectedProvince = provinceSelect.value;
        citySelect.innerHTML = '<option value="">Select City</option>';

        if (selectedProvince && data[selectedRegion][selectedProvince]) {
          citySelect.disabled = false;
          data[selectedRegion][selectedProvince].forEach((city) => {
            const option = document.createElement("option");
            option.value = city;
            option.textContent = city;
            citySelect.appendChild(option);
          });
        } else {
          citySelect.disabled = true;
        }
      });

      // Validasi Form
      document
        .getElementById("submitButton")
        .addEventListener("click", (event) => {
          event.preventDefault(); // Mencegah submit form default

          let isValid = true;

          // Reset semua error
          document
            .querySelectorAll(".error")
            .forEach((el) => (el.textContent = ""));

          // Validasi username
          const username = document.getElementById("username").value.trim();
          if (!username) {
            isValid = false;
            document.getElementById("usernameError").textContent =
              "Username is required.";
          }

          // Validasi email
          const email = document.getElementById("email").value.trim();
          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (!emailRegex.test(email)) {
            isValid = false;
            document.getElementById("emailError").textContent =
              "Please enter a valid email address.";
          }

          // Validasi password
          const password = document.getElementById("password").value;
          const passwordRegex =
            /^(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&#])[A-Za-z\d@$!%*?&#]{6,}$/;
          if (!passwordRegex.test(password)) {
            isValid = false;
            document.getElementById("passwordError").textContent =
              "Password must be at least 6 characters, include an uppercase letter, a number, and a special character.";
          }

          // Validasi dropdown
          const region = regionSelect.value;
          const province = provinceSelect.value;
          const city = citySelect.value;

          if (!region) {
            isValid = false;
            document.getElementById("regionError").textContent =
              "Region is required.";
          }
          if (!province) {
            isValid = false;
            document.getElementById("provinceError").textContent =
              "Province is required.";
          }
          if (!city) {
            isValid = false;
            document.getElementById("cityError").textContent =
              "City is required.";
          }

          // Cek email sudah terdaftar
          const users = JSON.parse(localStorage.getItem("users")) || [];
          if (users.find((user) => user.email === email)) {
            alert("Email sudah terdaftar. Silakan gunakan email lain.");
            return;
          }

          // Jika valid, simpan data pengguna
          if (isValid) {
            users.push({ username, email, password, region, province, city });
            localStorage.setItem("users", JSON.stringify(users));
            alert("Form submitted successfully!");
            window.location.href = "index.html"; // Sesuaikan nama file login
          }
        });

      // Toggle visibility password
      function togglePassword() {
        const passwordField = document.getElementById("password");
        passwordField.type =
          passwordField.type === "password" ? "text" : "password";
      }
    </script>
  </body>
</html>
